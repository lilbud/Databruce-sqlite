name: update database and push
on: push
jobs:
  updatedb:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ["3.7", "3.8", "3.9", "3.10", "3.11"]

    steps:
      - uses: actions/checkout@v3
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          python -m pip install -r requirements.txt
      - name: run database update
        run: |
          python -m update.py

  # # label of the container job
  # postgres-job:
  #   # containers must run in Linux based operating systems
  #   runs-on: ubuntu-latest
  #   # Docker Hub image that `postgres-job` executes in
  #   container: node:latest

  #   # service containers to run with `postgres-job`
  #   services:
  #     # label used to access the service container
  #     postgres:
  #       # Docker Hub image
  #       image: postgres:latest
  #       # service environment variables
  #       # `POSTGRES_HOST` is `postgres`
  #       env:
  #         # optional (defaults to `postgres`)
  #         POSTGRES_DB: postgres_db
  #         # required
  #         POSTGRES_PASSWORD: postgres_password
  #         # optional (defaults to `5432`)
  #         POSTGRES_PORT: 5432
  #         # optional (defaults to `postgres`)
  #         POSTGRES_USER: postgres_user
  #       ports:
  #         # maps tcp port 5432 on service container to the host
  #         - 5432:5432
  #       # set health checks to wait until postgres has started
  #       options: >-
  #         --health-cmd pg_isready
  #         --health-interval 10s
  #         --health-timeout 5s
  #         --health-retries 5

  #   steps:
  #     - name: Install PostgreSQL client
  #       run: |
  #         apt-get update
  #         apt-get install --yes postgresql-client
      
  #     - name: Install PGLoader
  #       run: |
  #         apt-get install --yes pgloader
